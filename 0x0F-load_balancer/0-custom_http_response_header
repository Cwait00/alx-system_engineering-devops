#!/usr/bin/env bash

# Install Nginx
sudo apt-get update
sudo apt-get install -y nginx

# Get the hostname of the server
HOSTNAME=$(hostname)

# Create a configuration file for the custom header
# Pad the hostname to ensure the header has the expected length
PADDED_HOSTNAME=$(printf "%-10s" "$HOSTNAME")
echo "add_header X-Served-By $PADDED_HOSTNAME;" | sudo tee /etc/nginx/sites-available/custom_header

# Create a symbolic link to the sites-enabled directory
sudo ln -s /etc/nginx/sites-available/custom_header /etc/nginx/sites-enabled/

# Remove the default symbolic link to the default configuration
sudo rm -f /etc/nginx/sites-enabled/default

# Restart Nginx to apply the changes
sudo systemctl restart nginx

# Exit with success status
exit 0
